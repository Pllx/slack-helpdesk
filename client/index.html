<!DOCTYPE html>
<head>
  <title>Statistics</title>
</head>

<style>
 .chart div{
   background-color: steelblue;
   text-align : right;
   padding : 3px;
   margin : 1px;
 }
</style>

<body>
  <script src="//code.jquery.com/jquery-1.11.3.min.js"></script>
  <script src="//d3js.org/d3.v3.min.js" charset="utf-8"></script>

  <h1>Welcome to ZomboCom!</h1>

  <div class="chart">
    <h2>Responses</h2>
  </div>
  <h4>You can do anything at ZomboCom. The only limit is yourself.</h4>


  <script>

  function createSampleAdmins() {
    var sampleAdmins = [];
    for (var i = 0 ; i < 10; i++) {
      var adminObj = {
        username : 'name' + i,
        closedRequests : []
      }
      for (var j = 0; j < i; j++) {
        adminObj.closedRequests.push('response'+j);
      }
      sampleAdmins.push(adminObj);
    }
    return sampleAdmins;
  }

    var admins;
    $.get('/api/adminTotals', function(data) {
      admins = data;

      admins = (!admins || !admins.length) ? admins : createSampleAdmins();
      console.log(admins);

      var MIN = 0;
      var max = admins[0].closedRequests.length;
      for (var i = 1; i < admins.length; i++) {
        max = (admins[i].closedRequests.length > max) ? admins[i].closedRequests.length : max;
      }

      var x = d3.scale.linear()
          .domain([MIN, max])
          .range([0,500]);

      d3.select('.chart')
        .selectAll('div')
          .data(admins)
        .enter().append('div')
          .style('width', function(d) { return x(d.closedRequests.length) + "px"})
          .text(function(d) {return d.username +" "+ d.closedRequests.length;});

    })

  </script>
</body>
